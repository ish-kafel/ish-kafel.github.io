<html>

<head>
  <meta charset="UTF-8">
  <style>
    button {
      float: left
    }

    #stop {
      display: none
    }
  </style>
  <script src="https://unpkg.com/color-js@1.0.3/color.js"></script>
</head>

<body>
  <button id='start'>开始</button>
  <button id='stop'>停止</button>
  <canvas id='canvas'></canvas>
</body>
<script src='L-system.js'></script>
<script>
  var Color = net.brehaut.Color;
  var ca = document.getElementById('canvas');
  var cx = ca.getContext('2d');
  ca.width = 500;
  ca.height = 800;

  var depth = 6
  var len = 6
  var direct = "r"
  var m = 50
  var n = 200
  var temp = 0, kk
  var axiom = 'F-G-G', angle = 120
  var drawV = ['F', 'G']
  var rules = ['F-G+F+G-F', 'GG']
  var gnrstr = lSystem(axiom, rules, drawV, depth)
  var drawstr = drawGnr(direct, angle, gnrstr, drawV)
  var sumlen=sumLen(gnrstr,drawV)
  cx.clearRect(0, 0, ca.width, ca.height);
  cx.lineWidth = 1
  kk=0
  function animateCanvas() {

    cx.beginPath()
    cx.moveTo(m, n)
    cx.strokeStyle = Color("hsl(" + 360 * kk / sumlen + ", 100%, 50%)")
    m += len*Math.sin(0.017453292519943295*drawstr[kk])
    n += len*Math.cos(0.017453292519943295*drawstr[kk])
    cx.lineTo(m, n)
    cx.stroke()

    if (kk != sumlen - 1) {
      setTimeout(animateCanvas, 1);
      kk++
    };
  }
  var start = document.getElementById('start');
  var stop = document.getElementById('stop');
  start.onclick = function () {
    start.style.display = "none";
    stop.style.display = "block";
    kk = temp
    animateCanvas();
  };
  stop.onclick = function () {
    start.style.display = 'block';
    stop.style.display = 'none'
    temp = kk
    kk = sumlen - 1;
  }
</script>

</html>